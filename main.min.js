const WEEK_DAYS=[{short:"Sun",long:"Sunday"},{short:"Mon",long:"Monday"},{short:"Tue",long:"Tuesday"},{short:"Wed",long:"Wednesday"},{short:"Thu",long:"Thursrday"},{short:"Fri",long:"Friday"},{short:"Sat",long:"Saturday"},],HOURS_OF_A_DAY=["All Day","12AM","1AM","2AM","3AM","4AM","5AM","6AM","7AM","8AM","9AM","10AM","11AM","12PM","1PM","2PM","3PM","4PM","5PM","6PM","7PM","8PM","9PM","10PM","11PM",];function getDateString(b){let a=new Date(b),c=a.getMonth()+1,d=a.getDate(),e=a.getFullYear();return`${c}/${d}/${e}`}function renderDateRowsOfAMonth(d,g){let j=document.getElementById(`monthTableBody_${this.uniqueCalendarId}`),a=1,h="",e=new Date,k=e.getDate(),l=e.getMonth(),m=e.getFullYear(),n=d.getMonth(),o=d.toString().split(" ")[0];for(;a<=g.getDate();){let b="<tr class='dateRow'>";for(let f=0;f<7;f++){let c=new Date(d);c.setDate(d.getDate()+(a-1));let i=a===k&&l===n&&c.getFullYear()===m;1===a?o===WEEK_DAYS[f].short?(b+=`
            <td data-date="${getDateString(c)}"
                class="dateCell ${i?"currentDay":""}"
            >
              ${a}
            </td>`,a++):b+='<td class="dateCell"></td>':a>g.getDate()?b+='<td class="dateCell"></td>':(b+=`
            <td data-date="${getDateString(c)}"
                class="dateCell ${i?"currentDay":""}"
            >
              ${a}
            </td>`,a++)}b+="</tr>",h+=b}j.innerHTML=h}function initMonthNavButtons(){document.getElementById(`nextMonth_${this.uniqueCalendarId}`).addEventListener("click",()=>{this.diffBetCurrentAndDisplayMonth++,this.renderMonthView()}),document.getElementById(`previousMonth_${this.uniqueCalendarId}`).addEventListener("click",()=>{this.diffBetCurrentAndDisplayMonth--,this.renderMonthView()})}function renderMonthView(){let a=new Date;a.setDate(1),0!==this.diffBetCurrentAndDisplayMonth&&a.setMonth(a.getMonth()+this.diffBetCurrentAndDisplayMonth);let c=a.getMonth(),b=a.getFullYear(),d=new Date(b,c+1,0),e=document.getElementById(`monthHeading_${this.uniqueCalendarId}`);e.innerText=`${a.toLocaleDateString("en-us",{month:"long"})} ${b}`,renderDateRowsOfAMonth.call(this,a,d)}function getWeekDates(c){let b=[],a=new Date(c);for(let d=0;d<7;d++){let f=a.toString().split(" ")[0],g=WEEK_DAYS.findIndex(a=>a.short===f),h=new Date(a);if(b[g]=h,a.setDate(a.getDate()-1),"Sun"===f)break}if(b.length<7){a=new Date(c);for(let e=0;e<7;e++){a.setDate(a.getDate()+1);let i=a.toString().split(" ")[0],j=WEEK_DAYS.findIndex(a=>a.short===i),k=new Date(a);if(b[j]=k,"Sat"===i)break}}return b}function renderHourRowsOfAWeek(c){let a=document.getElementById(`weekTableBody_${this.uniqueCalendarId}`),b="";HOURS_OF_A_DAY.forEach(f=>{let a="<tr class='hourRow'>";a+=`<td class="hourCell">${f}</td>`;for(let d=0;d<7;d++){let e=new Date(c);e.setDate(e.getDate()+d),a+=`<td data-hour="${f}" data-date=${getDateString(e)} class="hourCell"></td>`}a+="</tr>",b+=a}),a.innerHTML=b}function initWeekNavButtons(){document.getElementById(`nextWeek_${this.uniqueCalendarId}`).addEventListener("click",()=>{this.diffBetCurrentAndDisplayWeek++,this.renderWeekView()}),document.getElementById(`previousWeek_${this.uniqueCalendarId}`).addEventListener("click",()=>{this.diffBetCurrentAndDisplayWeek--,this.renderWeekView()})}function renderWeekView(){let h=document.getElementById(`weekTableHeadingsRow_${this.uniqueCalendarId}`),i=document.getElementById(`weekHeading_${this.uniqueCalendarId}`),b=new Date;0!==this.diffBetCurrentAndDisplayWeek&&b.setDate(new Date().getDate()+7*this.diffBetCurrentAndDisplayWeek);let a=getWeekDates(b),d=b.getFullYear(),e=a[0].getDate(),c=a[0].toString().split(" ")[1],f=a[6].toString().split(" ")[1],g=a[6].getDate();i.innerText=c===f?`${c} ${e}-${g}, ${d}`:`${c} ${e} - ${f} ${g}, ${d}`;let j="<th></th>";a.forEach(a=>{let b=a.toString().split(" ")[0],c=`${b} ${a.getMonth()+1}/${a.getDate()}`;j+=`<th>${c}</th>`}),h.innerHTML=j,renderHourRowsOfAWeek.call(this,a[0])}function renderHourRowsOfADay(c){let a=document.getElementById(`dayTableBody_${this.uniqueCalendarId}`),b="";HOURS_OF_A_DAY.forEach(d=>{let a="<tr class='hourRow'>";a+=`<td class="hourCell">${d}</td>`,a+=`<td style="flex:4" data-hour="${d}" data-date=${getDateString(c)} class="hourCell"></td>`,a+="</tr>",b+=a}),a.innerHTML=b}function initDayNavButtons(){document.getElementById(`nextDay_${this.uniqueCalendarId}`).addEventListener("click",()=>{this.diffBetCurrentAndDisplayDate++,this.renderDayView()}),document.getElementById(`previousDay_${this.uniqueCalendarId}`).addEventListener("click",()=>{this.diffBetCurrentAndDisplayDate--,this.renderDayView()})}function renderDayView(){let d=document.getElementById(`dayHeading_${this.uniqueCalendarId}`),e=document.getElementById(`dayTableHeading_${this.uniqueCalendarId}`),a=new Date;0!==this.nthDayFromCurrentDay&&a.setDate(a.getDate()+this.diffBetCurrentAndDisplayDate);let b=a.toString().split(" "),f=a.getFullYear(),g=b[1],c=b[0];c=WEEK_DAYS.find(a=>a.short===c),d.innerText=`${g} ${a.getDate()}, ${f}`,e.innerHTML=`<th>${c.long}</th>`,renderHourRowsOfADay.call(this,a)}function Calendar(a){this.activeViewId=`monthView_${a}`,this.uniqueCalendarId=a,this.diffBetCurrentAndDisplayMonth=0,this.diffBetCurrentAndDisplayWeek=0,this.diffBetCurrentAndDisplayDate=0,this.render=(function(){let c=this.uniqueCalendarId,d=document.getElementById(a);d.innerHTML=`
      <div id="calendar_${c}" class="calendar">
        <div class="viewToggleButtonsContainer">
          <button id="viewToggleButton_${c}" data-target-id="monthView_${c}" class="cal-button viewToggleButton active">Month</button>
          <button id="viewToggleButton_${c}" data-target-id="weekView_${c}" class="cal-button viewToggleButton">Week</button>
          <button id="viewToggleButton_${c}" data-target-id="dayView_${c}" class="cal-button viewToggleButton">Day</button>
        </div>
        <hr>
    
        <div id="monthView_${c}" class="view active">
          <div class="calendarHeader">
            <div id="monthHeading_${c}"></div>
            <div class="navButtonsContainer">
              <button id="previousMonth_${c}" class="cal-button navButton">Back</button>
              <button id="nextMonth_${c}" class="cal-button navButton">Next</button>
            </div>
          </div>
          <table class="viewTable">
            <thead id="monthTableHeader_${c}">
              <tr class="shortWeekdaysRow tableHeadings">
                <th>Sun</th>
                <th>Mon</th>
                <th>Tue</th>
                <th>Wed</th>
                <th>Thu</th>
                <th>Fri</th>
                <th>Sat</th>
              </tr>
              <tr class="longWeekdaysRow tableHeadings">
                <th>Sunday</th>
                <th>Monday</th>
                <th>Tuesday</th>
                <th>Wednesday</th>
                <th>Thursrday</th>
                <th>Friday</th>
                <th>Saturday</th>
              </tr>
            </thead>
            <tbody id="monthTableBody_${c}">
    
            </tbody>
          </table>
        </div>
        <div id="weekView_${c}" class="view">
          <div class="calendarHeader">
            <div id="weekHeading_${c}"></div>
            <div class="navButtonsContainer">
              <button id="previousWeek_${c}" class="cal-button navButton">Back</button>
              <button id="nextWeek_${c}" class="cal-button navButton">Next</button>
            </div>
          </div>
          <table class="viewTable">
            <thead>
              <tr id="weekTableHeadingsRow_${c}" class="tableHeadings">
    
              </tr>
            </thead>
            <tbody id="weekTableBody_${c}" class="weekTableBody">
              
            </tbody>
          </table>
    
        </div>
        <div id="dayView_${c}" class="view">
          <div class="calendarHeader">
            <div id="dayHeading_${c}"> </div>
            <div class="navButtonsContainer">
              <button id="previousDay_${c}" class="cal-button navButton">Back</button>
              <button id="nextDay_${c}" class="cal-button navButton">Next</button>
            </div>
          </div>
          <table class="viewTable">
            <thead>
              <tr class="tableHeadings">
                <th id="dayTableHeading_${c}"></th>
              </tr>
            </thead>
            <tbody id="dayTableBody_${c}" class="dayTableBody">
              
            </tbody>
          </table>
    
        </div>
      </div>
      `;let e=document.querySelectorAll(".viewToggleButton");e.forEach(a=>a.addEventListener("click",b.bind(this))),this.renderMonthView(),initMonthNavButtons.call(this),initWeekNavButtons.call(this),initDayNavButtons.call(this)}).bind(this),this.renderMonthView=renderMonthView.bind(this),this.renderWeekView=renderWeekView.bind(this),this.renderDayView=renderDayView.bind(this),this.viewInitialisers={[`monthView_${a}`]:this.renderMonthView,[`weekView_${a}`]:this.renderWeekView,[`dayView_${a}`]:this.renderDayView};function b(a){let c=a.currentTarget.className.includes("active");if(c)return;let d=document.getElementById(this.activeViewId),e=document.querySelector(".viewToggleButton.active"),b=a.target.getAttribute("data-target-id"),f=document.getElementById(b);d.classList.remove("active"),f.classList.add("active"),e.classList.remove("active"),a.target.classList.add("active"),this.activeViewId=b,this.viewInitialisers[this.activeViewId]()}}function truncateText(a,b){return a.length<=b?a:a.slice(0,b)+"..."}function createEventDiv(b,c){let a=document.createElement("div");return a.className="event",a.setAttribute("data-eventTitle",b.title),a.setAttribute("data-eventId",b.id),a.innerText=c?truncateText(b.title,20):b.title,a}function clearEventsFromCells(a){let b=document.querySelectorAll(`#${a} td`);b.forEach(a=>{let b=[...a.children];b.forEach(b=>{b.className.includes("event")&&a.removeChild(b)})})}function insertEventsInCells(a,b){clearEventsFromCells(a),b.forEach(b=>{let c,f=b.time,d=getDateString(b.date),g=a.includes("month"),h=a.includes("day");c=g?`#${a} [data-date="${d}"]`:`#${a} [data-date="${d}"][data-hour="${f}"]`;let e=document.querySelector(c);if(e){let i=!h,j=createEventDiv(b,i);e.appendChild(j)}})}function getEventStartAndEndDate(e,b){let c=new Date(e),d=new Date(e);if("All Day"===b)d.setDate(c.getDate()+1);else{let a=Number(b.slice(0,-2)),f=b.slice(-2);"PM"===f?a+=12:"AM"===f&&12===a&&(a=0),c.setHours(a),d.setHours(a+1)}return{eventStartDate:c,eventEndDate:d}}function addEventsPluginToCalendar(c,d){let{uniqueCalendarId:a}=c,e=localStorage.getItem(`${a}_eventsList`)?JSON.parse(localStorage.getItem(`${a}_eventsList`)):[],h=d?.eventsList??e,f=document.querySelectorAll(`#${a} .navButton`),g=document.querySelectorAll(`#${a} .viewToggleButton`);function b(){let{activeViewId:b}=c;switch(d?.eventsList&&(h=d.eventsList),b){case`monthView_${a}`:insertEventsInCells(`monthView_${a}`,h);break;case`weekView_${a}`:insertEventsInCells(`weekView_${a}`,h);break;case`dayView_${a}`:insertEventsInCells(`dayView_${a}`,h)}}return f.forEach(a=>a.addEventListener("click",b)),g.forEach(a=>a.addEventListener("click",b)),b(),!function(){let c=document.querySelectorAll(`#${a} table tbody`);c.forEach(c=>{c.addEventListener("click",i=>{let{target:c}=i,j=c.getAttribute("data-date")&&(c.className.includes("dateCell")||c.className.includes("hourCell"));if(j){let e=c.getAttribute("data-date"),f=c.getAttribute("data-hour")??"All Day";if(d?.createNewEvent){d?.createNewEvent(e,f);return}!function(c,d){let{eventStartDate:f,eventEndDate:g}=getEventStartAndEndDate(c,d),i=`Create an event from ${f} to ${g}`,e=prompt(i);if(""!==e.trim()){let j=`${c}_${d}_${e}`,k=h.some(({id:a})=>a===j);if(k)return;let l={id:j,date:c,title:e,time:d};h.push(l),localStorage.setItem(`${a}_eventsList`,JSON.stringify(h)),b()}}(e,f)}else if("event"===c.className){let k=c.getAttribute("data-eventId"),g=h.find(({id:a})=>a===k);if(d?.displayEventDetails){d?.displayEventDetails(g);return}!function(c){let{date:e,time:f,title:g}=c,{eventStartDate:i,eventEndDate:j}=getEventStartAndEndDate(e,f),k=`Title: ${g} 
                              
Duration: ${i} to ${j} 
                              

To DELETE the event, press "OK", else press "Cancel"`,l=confirm(k);if(l){if(d?.deleteEvent){d?.deleteEvent(c);return}(function(d){let c=h.findIndex(({id:a})=>a===d.id);h.splice(c,1),localStorage.setItem(`${a}_eventsList`,JSON.stringify(h)),b()})(c)}}(g)}})})}(),b}